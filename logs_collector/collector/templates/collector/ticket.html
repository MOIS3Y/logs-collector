{% extends 'collector/base.html' %} 
{% block content %} 
{% include 'collector/navigation.html' %}
<main>
  <section>
    <div class="container mt-3">
      <div class="row">
        <div class="list-group mb-2">
          <div class="list-group-item list-group-item-action disable" aria-current="true">
            <div class="d-flex w-100 justify-content-between mb-2">
              <h5 class="mb-1">Ticket: {{ ticket.number }}</h5>
              <small>{{ ticket.time_create }}</small>
            </div>
            <div class="col-xl-6 mb-2">
              <h6 class="mb-1">Platform: {{ ticket.platform.pretty_name }}</h6>
              <h6 class="mb-1">Owner: {{ ticket.user.username }}</h6>
            </div>   
            <div class="col-xl-6 mt-1 mb-2">
              {% if ticket.note %}
                <small><b>Note:</b></small>
                <hr>
                  <p>{{ ticket.note }}</p>
                <hr>
              {% endif %}
            </div>
            <!-- Logs -->
            {% if ticket.archive_set.all %}
            <small><b>Logs:</b></small>
            <ul class="list-group mb-2 mt-2">
            {% for archive in ticket.archive_set.all %}
              <li class="list-group-item list-group-item-action">
                <p style="word-wrap: break-word" ><b>File:</b> {{ archive.file }}</p>
                <small>
                  <b>SHA1:</b>
                  <span style="word-wrap: break-word">{{ archive.sha1 }}</span>
                </small>
                <br>
                <small>
                  <b>Size:</b>
                  <span style="word-wrap: break-word">{{ archive.size }}</span>
                </small>
                <div class="row">
                  <div class="col" >
                    <a
                      class="btn btn-outline-success btn-sm mt-2"
                      href="{{ archive.get_absolute_url }}"
                    >GET</a>
                    <button
                    class="btn btn-outline-danger btn-sm ms-2 mt-2"
                    button type="button" data-bs-toggle="modal" data-bs-target="#modal-archive-del-{{ archive.id }}"
                    >DEL</button>
                  </div>
                </div>
              </li>
            {% endfor %}
            </ul>
            {% endif %}
            <!-- Card buttons -->
            <div class="d-flex w-100 justify-content-between">
              <a
                href="{{ ticket.get_absolute_url }}"
                class="btn btn-outline-warning mb-1 mt-1"
              >Edit</a>
              <a
                href="{{ ticket.get_absolute_url }}"
                class="btn btn-outline-danger mb-1 mt-1"
              >Delete</a>
            </div>
          </div>
        </div>
      </div>
      <!-- Modal -->
      {% for archive in ticket.archive_set.all %}
      <div class="modal fade" id="modal-archive-del-{{ archive.id }}" tabindex="-1" aria-labelledby="LabelArchive-{{ archive.id }}" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="LabelArchive-{{ archive.id }}">Delete this file?</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <p style="word-wrap: break-word">{{ archive.file }}</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
              <button type="button" class="btn btn-danger">Delete</button>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </section>
</main>
{% endblock content %}
